<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MilliOhmMeter: MilliOhmMeter.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MilliOhmMeter
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">MilliOhm Meter Firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">MilliOhmMeter.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;avr/pgmspace.h&gt;</code><br/>
<code>#include &lt;Arduino.h&gt;</code><br/>
<code>#include &lt;Wire.h&gt;</code><br/>
<code>#include &lt;SPI.h&gt;</code><br/>
<code>#include &lt;gfxfont.h&gt;</code><br/>
<code>#include &lt;Adafruit_GFX.h&gt;</code><br/>
<code>#include &lt;Adafruit_ILI9341.h&gt;</code><br/>
<code>#include &lt;Adafruit_ADS1015.h&gt;</code><br/>
<code>#include &lt;TimerUp.h&gt;</code><br/>
<code>#include &quot;Filter.h&quot;</code><br/>
<code>#include &quot;printf.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="_milli_ohm_meter_8h_source.html">MilliOhmMeter.h</a>&quot;</code><br/>
</div>
<p><a href="_milli_ohm_meter_8ino_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program setup.  <a href="#a4fc01d736fe50cf5b977f755b675f11d">More...</a><br/></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main program loop.  <a href="#afe461d27b9c48d5921c00d521181f12f">More...</a><br/></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f1779f400e8f8219dfe38e1667aa94"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a68f1779f400e8f8219dfe38e1667aa94">dToStringFmt</a> (double val, uint8_t len, uint8_t prec, char *buf)</td></tr>
<tr class="memdesc:a68f1779f400e8f8219dfe38e1667aa94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a double value to a formatted string.  <a href="#a68f1779f400e8f8219dfe38e1667aa94">More...</a><br/></td></tr>
<tr class="separator:a68f1779f400e8f8219dfe38e1667aa94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7eb3c8c2e8604801ee00f11d3af8c3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#ab7eb3c8c2e8604801ee00f11d3af8c3f">updateDisplay</a> ()</td></tr>
<tr class="memdesc:ab7eb3c8c2e8604801ee00f11d3af8c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the values displayed on the LCD.  <a href="#ab7eb3c8c2e8604801ee00f11d3af8c3f">More...</a><br/></td></tr>
<tr class="separator:ab7eb3c8c2e8604801ee00f11d3af8c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a74727714a096c3367809fb212e1b3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a2a74727714a096c3367809fb212e1b3b">drawBatteryStatus</a> (uint8_t charge, <a class="el" href="_milli_ohm_meter_8h.html#ac8776b96d749ba6bdfb057c808e61d31">BatState</a> status)</td></tr>
<tr class="memdesc:a2a74727714a096c3367809fb212e1b3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw the battery charge status indicator.  <a href="#a2a74727714a096c3367809fb212e1b3b">More...</a><br/></td></tr>
<tr class="separator:a2a74727714a096c3367809fb212e1b3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5c6e5b1c80c93de5420e1fae096c56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#aca5c6e5b1c80c93de5420e1fae096c56">getResistance</a> ()</td></tr>
<tr class="memdesc:aca5c6e5b1c80c93de5420e1fae096c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the resistance value.  <a href="#aca5c6e5b1c80c93de5420e1fae096c56">More...</a><br/></td></tr>
<tr class="separator:aca5c6e5b1c80c93de5420e1fae096c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7752c1a0a14c86fe69172c521aedd0c6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a7752c1a0a14c86fe69172c521aedd0c6">adjustGain</a> (<a class="el" href="_milli_ohm_meter_8h.html#a2e9ec086ba61b35cfc2439306cdfdd70">Direction_t</a> dir)</td></tr>
<tr class="memdesc:a7752c1a0a14c86fe69172c521aedd0c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the gain of the A/D converter PGA.  <a href="#a7752c1a0a14c86fe69172c521aedd0c6">More...</a><br/></td></tr>
<tr class="separator:a7752c1a0a14c86fe69172c521aedd0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1cb6090825d3e387191264c221e898a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#af1cb6090825d3e387191264c221e898a">initBattery</a> ()</td></tr>
<tr class="memdesc:af1cb6090825d3e387191264c221e898a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the battery monitoring hardware.  <a href="#af1cb6090825d3e387191264c221e898a">More...</a><br/></td></tr>
<tr class="separator:af1cb6090825d3e387191264c221e898a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa001cd2d4343cc0f50d664f0ae0899e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#aa001cd2d4343cc0f50d664f0ae0899e4">getBattVolts</a> ()</td></tr>
<tr class="memdesc:aa001cd2d4343cc0f50d664f0ae0899e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the battery voltage.  <a href="#aa001cd2d4343cc0f50d664f0ae0899e4">More...</a><br/></td></tr>
<tr class="separator:aa001cd2d4343cc0f50d664f0ae0899e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e334fd582a89ab2ebae6e3939489f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a03e334fd582a89ab2ebae6e3939489f5">initAds1115</a> ()</td></tr>
<tr class="memdesc:a03e334fd582a89ab2ebae6e3939489f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the ADS1115 16b A/D converter.  <a href="#a03e334fd582a89ab2ebae6e3939489f5">More...</a><br/></td></tr>
<tr class="separator:a03e334fd582a89ab2ebae6e3939489f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7722a7949ea0b9260e5ea6d47b1cb87f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#a7722a7949ea0b9260e5ea6d47b1cb87f">writeLcdText</a> (char *buf, int16_t x, int16_t y, uint8_t size, <a class="el" href="_milli_ohm_meter_8h.html#a86946be575797b2acea8036d60addf04">LcdTxtJust</a> just, uint16_t fgcolor, boolean clear)</td></tr>
<tr class="memdesc:a7722a7949ea0b9260e5ea6d47b1cb87f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a text string to the LCD.  <a href="#a7722a7949ea0b9260e5ea6d47b1cb87f">More...</a><br/></td></tr>
<tr class="separator:a7722a7949ea0b9260e5ea6d47b1cb87f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f84952daad8f46512a59ee823ac0a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_milli_ohm_meter_8ino.html#ad6f84952daad8f46512a59ee823ac0a4">initLcd</a> ()</td></tr>
<tr class="memdesc:ad6f84952daad8f46512a59ee823ac0a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the LCD.  <a href="#ad6f84952daad8f46512a59ee823ac0a4">More...</a><br/></td></tr>
<tr class="separator:ad6f84952daad8f46512a59ee823ac0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section user"><dt>MilliOhmMeter Control Program - Source File.</dt><dd></dd></dl>
<dl class="section user"><dt>Details</dt><dd>Firmware for MilliOhm Meter using the following hardware; <ul>
<li>Scullcom milliohm meter circuit </li>
<li>Arduino Pro Mini </li>
<li>ADS1115 breakout board </li>
<li>2.2" 240x320 SPI TFT LCD with ILI9341 driver </li>
<li>Micro USB single LiIon battery charger module </li>
<li>LiIon single cell boost converter module </li>
<li>18650 2500mAh LiIon cyclindrical cell</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>J. F. Fitter <a href="#" onclick="location.href='mai'+'lto:'+'jfi'+'tt'+'er@'+'ea'+'gle'+'ai'+'rau'+'st'+'.co'+'m.'+'au'; return false;">jfitt<span style="display: none;">.nosp@m.</span>er@e<span style="display: none;">.nosp@m.</span>aglea<span style="display: none;">.nosp@m.</span>irau<span style="display: none;">.nosp@m.</span>st.co<span style="display: none;">.nosp@m.</span>m.au</a> </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 2017 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2017 John Fitter. All right reserved.</dd></dl>
<dl class="section user"><dt>Changelog</dt><dd>23jul2017 Initial release</dd></dl>
<dl class="section user"><dt>License</dt><dd>This program is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation; either version 2.1 of the License, or (at your option) any later version. </dd></dl>
<dl class="section user"><dt></dt><dd>This Program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details at <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> </dd></dl>
<dl class="section user"><dt></dt><dd>You should have received a copy of the GNU Lesser General Public License along with this library; if not, write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt>Hardware setup.</dt><dd>Using an Arduino Pro Mini @ 16MHz / 5V. <pre class="fragment">Description &amp; Function                     Arduino    Arduino
======================                     Pin #      Pin Name
                                           =======    ========
ADS1115 16b A/D Converter I2C
    SDA   (Serial Data)                    A4         ADC4 (SDA)
    SCL   (Serial Clock)                   A5         ADC5 (SCL)

2.2" TFT RGB 240x320 Display (ILI9341)
    MISO  (Serial Out)                     12         PB4 (MISO) (Serial In)
    MOSI  (Serial In)                      11         PB3 (MOSI) (Serial Out)
    SCK   (Serial Clock)                   13         PB5 (SCK)  (Serial Clock)
    LED   (Backlight)                      2          PD2
    DC/RS (SD Card Select)                 3          PD3
    RST   (Reset)                          4          PD4
    CS    (LCD Select)                     5          PD5

ADS1115 Analog Inputs
    0,1   Differential                     MilliOhm meter output
    2     Single ended                     LiIon battery voltage
</pre> </dd></dl>

<p>Definition in file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7752c1a0a14c86fe69172c521aedd0c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double adjustGain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_milli_ohm_meter_8h.html#a2e9ec086ba61b35cfc2439306cdfdd70">Direction_t</a>&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the gain of the A/D converter PGA. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Changes the gain by one step only, either up, down, or no change. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Direction_t</td><td>dir Direction to adjust the gain. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double gain factor (Ohms/bit). </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00317">317</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="a2a74727714a096c3367809fb212e1b3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawBatteryStatus </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_milli_ohm_meter_8h.html#ac8776b96d749ba6bdfb057c808e61d31">BatState</a>&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw the battery charge status indicator. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Draws an indicator bar on the LCD showing the amount of charge remaining in the battery and overlain by the battery state in text. If the battery is charging then a charging symbol is shown. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uint8_t</td><td>charge The charge level of the battery in 1/2% increments (0..200). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">BatState</td><td>status The charge status of the battery. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00216">216</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="a68f1779f400e8f8219dfe38e1667aa94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dToStringFmt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a double value to a formatted string. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Unlike dtostrf() this procedure returns a string of only the specified length, leading edge padded with spaces or truncated. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>val Value to be converted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint8_t</td><td>len Length of the string to return. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint8_t</td><td>prec Precision (ie. number of decimals). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>*buf String buffer to receive the result. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char* Pointer to the formatted string buffer. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00118">118</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="aa001cd2d4343cc0f50d664f0ae0899e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getBattVolts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the battery voltage. </p>
<dl class="section remark"><dt>Remarks</dt><dd>The battery is a single LiIon cylindrical cell. It is nominally 3.7V and 4.2V at full charge. It is 2.4V fully discharged. The voltage is measured single ended (ie. referenced to ground) and the gain is set for a 6.144V range. On completion the gain is restored to its previous value. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00363">363</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="aca5c6e5b1c80c93de5420e1fae096c56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getResistance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the resistance value. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Reads the A/D converter to get raw data then converts it to a resistance. The resistance value is filtered with a digital filter and the difference between the computed resistance and the filtered resistance is squared and filtered. The filters implement simple linear recursive exponential filters. These are essentially first order FIR filters which are ideal for the removal of white noise typically found on sensor data. They are not suitable for spectral filtering. </dd></dl>
<dl class="section user"><dt></dt><dd>The meter circuit provides 100mA of source current so the resistance is equal to Measured Voltage * 10 where Measured Voltage is the raw a/d value multiplied by a gain factor in V/bit. </dd></dl>
<dl class="section user"><dt></dt><dd>The raw a/d value is compared to the hysteresis limit for the purpose of changing the gain of the PGA. If the raw value is below the lower limit then the gain is increased. If the value is above the upper limit then the gain is reduced. The hysteresis is necessary to prevent the display from flickering between ranges. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00285">285</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="a03e334fd582a89ab2ebae6e3939489f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initAds1115 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the ADS1115 16b A/D converter. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Starts the converter and sets the converter to the default gain. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00399">399</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="af1cb6090825d3e387191264c221e898a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initBattery </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the battery monitoring hardware. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This is just 2 pins to monitor the status of the TP4056 status pins. These pins are open drain and drive 2 on-board LEDs connected to USB power. The CPU can monitor them through a series diode thereby preventing the CPU pins from being energised by the charger when the CPU power is removed (switch off). </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00350">350</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="ad6f84952daad8f46512a59ee823ac0a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initLcd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the LCD. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Sets up the LCD orientation, background color, text color, text wrap and mode. <ul>
<li>Initializes the backlight PWM modulator. </li>
<li>Writes the splash screen, pauses, then fills the screen with the background color. </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00433">433</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="afe461d27b9c48d5921c00d521181f12f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main program loop. </p>
<dl class="section remark"><dt>Remarks</dt><dd>The main loop is merely a scheduler relying on the rollover of several timers to initiate functions. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00102">102</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Program setup. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Performed once only at powerup. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00084">84</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="ab7eb3c8c2e8604801ee00f11d3af8c3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateDisplay </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the values displayed on the LCD. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This procedure writes all of the variable data to the LCD. It performs Implement a simple linear recursive exponential filter. This is scaling of the value and selection of the appropriate units. </dd></dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00129">129</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
<a class="anchor" id="a7722a7949ea0b9260e5ea6d47b1cb87f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeLcdText </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_milli_ohm_meter_8h.html#a86946be575797b2acea8036d60addf04">LcdTxtJust</a>&#160;</td>
          <td class="paramname"><em>just</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>fgcolor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>clear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a text string to the LCD. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Generic text string writer. Draws the text clear. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char*</td><td>buf Buffer containing the string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int16_t</td><td>x X position of the string reference in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int16_t</td><td>y Y position of the string reference in pixels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint8_t</td><td>size Text size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LcdTxtJust</td><td>just Location of the string reference. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint16_t</td><td>fgcolor Color of the text. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_milli_ohm_meter_8ino_source.html#l00414">414</a> of file <a class="el" href="_milli_ohm_meter_8ino_source.html">MilliOhmMeter.ino</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 1 2017 19:23:23 for MilliOhmMeter by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
